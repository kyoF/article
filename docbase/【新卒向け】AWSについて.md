【新卒向け】AWSについて勉強した
# 【AWSとは】
* Amazon Web Serviceの略で、Amazonが提供しているクラウドサービスの総称
* Amazonでは、購買がクリスマスの日に増大する。
* それに対応するためにサーバーを増やしたが、クリスマス以外は全く使っていない。
* これを有効活用しようと始めたのがAWSの始まり。
* 現在のAmazonの売上高の約11%はAWSによるものである。

# 【クラウド（サービス）とは】
* インターネットを利用して様々なサービスを提供するサービスのこと
* 対して、サーバーやコンピュータ、ソフトウェアなどを自社に設置して運用するサービスをオンプレミスという
* さらにクラウドサービスにも種類があり、広く一般ユーザや企業にサービスを提供するサービスをパブリッククラウドといい、企業や組織が自社内でクラウドサービスを構築し、特定のユーザだけが利用できるサービスのことをプライベートクラウドという

# 【AWS基本知識】

## リージョン
* AWSの各サービスが提供されている地域のこと
* 日本のリージョン
    * ap-northeast-1（アジアパシフィック(東京)）
    * ap-northeast-3（アジアパシフィック(大阪)）←NEW

## アベイラビリティゾーン(AZ)
* リージョン内のさらに細かい拠点
* 1つのアベイラビリティゾーンは複数のデータセンターから構成されている
* アジアパシフィックには3つのアベイラビリティゾーンがある

## VPC (Virtual Private Cloud)
* AWS内で作る自分だけのネットワーク
* 自由にIPアドレスを割り当てられる

## サブネット
* VPCのさらに内側に作る、EC2インスタンス（後述）などを起動するための領域
* パブリックサブネットとプライベートサブネットがあり、インターネットゲートウェイ（後述）から直接アクセスできるかできないかの違いがある。

## ルートテーブル
* サブネット内のインスタンスの通信先のルールを定めたもの
* サブネットごとに決める

## ゲートウェイ
* VPCの内部と外部の通信をやり取りする出入口
* インターネットゲートウェイは、インターネットのVPCを接続するためのゲートウェイ
* NATゲートウェイは、プライベートIPしかもっていないEC2インスタンスがインターネットと通信できるようにするためのもの
* VPCエンドポイント(ゲートウェイエンドポイント)は、S3（後述）やDynamoDB（後述）といったVPCの中に入れられないサービスにVPC内から接続する際に利用する

# 【webサイトのAWS構成図によく出てくるサービス】

## EC2 (Elastic Compute Cloud)
* AWS上に仮想サーバーを置いて様々やWebアプリケーションを動かすことが出来るサービス
* ユーザの必要に応じてスペックを変更できる
* EC2上で稼働するサーバのことをEC2インスタンスと呼ぶ

## RDS (Relational Database Service)
* データ間の関係性が定義されたデータを取り扱う一般的なDBシステム
* 列と行がいくつかのテーブルで定義されていて、テーブル間のリレーションが設計されている
* データ操作にSQLを利用する
* 障害や誤作動が起きたときに5分前の状態に戻すことが出来る
* オートスケールはできない
* ストレージサイズを増やすことはできるが減らすことはできない
* スケールアップ時はインスタンス再起動によるダウンタイムが発生するため、ダウンタイムのすくないauroraやdyamodbのようにキャパシティを指定するだけのオートスケール可能なDBを選択する必要がある
* プライベートサブネットの配置するのが基本
* 別のAZにスタンバイコピーされるため、障害が発生した場合にスタンバイに切り替わる（フェイルオーバー）
* EC2でSQLをインストールして利用することもできるが、バックアップデータの作成や脆弱性パッチの適用といったいろいろな面倒ごとをRDSにお任せできる。ただ、自由度は下がる。

## S3 (Simple Strage Service)
* ストレージ機能
* ファイルのバックアップやファイル処理の加工前後のファイル保存、画像ファイルやCSSなどWebで使う静的なファイルを置くことを目的としている
* S3は事前に保存容量を決める必要はなく、入れた分だけの課金となるため、ストレージの空きを気にする必要がない

## ELB (Elastic Load Balancing)
* 集中するトラフィックを分散して、サービスの稼働を安定させることが出来る
* メンテナンスや障害発生時にこれの設定を行うことで、該当のサーバーへのリクエストのみを止めることが出来る
* ALB(Application Load Balancer)、NLB(Network Load Balancer)、CLB(Classic Load Balancer)の三つを総称してELBという

## AWS Certificate Manager
* SSL証明書が無料で発行・自動更新できる

## Cloud Watch
* AWSの各種リソースを監視してくれるもの
* セットアップが不要で、異常な状態を検知し自動復旧を行い、メトリクスに応じてアラート通知やアクションを設定することが出来る
* メトリクスとは、監査対象の変数の設定（何を監視するのか）
* CloudWatch、CloudWatch Logs、CloudWatch Eventsの3つからなるサービス
* リソースを管理するのがCloudwatch。CPUやメモリなど複数項目をグラフ化してダッシュボードを作れる
* ログを集めて監視するのがCloudWatch Logsで、アプリケーションやOSでエラーログをはいたら管理者にメール通知することができる
* APIのイベントをトリガーに何らかのアクションを実行させることが出来るサービスをCloudWatch Eventsという
* AWSではEC2インスタンスの起動停止もAPIで実行されているため、こういったイベントを監視することで、特定の処理に対してアクションを実行することができる
* 負荷に応じてオートスケールするAWSに対応するため、監査対象のサーバが増えたら、その対象が勝手に通知を送ってくるようになるため、既存の監視サービスよりCloud Watchを使うほうがよいとされいている
* サーバに対してCPUやメモリを監視するだけでなく、サーバーがないサービスに対しても同じように監視することが出来る
* S3にログをエクスポートして、データ解析するなど、AWSのサービスをフルで活用することが出来ることもメリットである

## ElasticCache
* キャッシュ
 * 一度アクセスしたWebページの情報をブラウザやノード側で一時的に保管し、次にまた同じページにアクセスした際の表示を早くする仕組みまたはそのデータそのものを指す
 * Webページを表示する際は、都度そのページのデータをダウンロードする必要があるが、キャッシュという一時的なデータが端末側にあることで、表示スピードを向上させることが出来る
* メインメモリキャッシュのデプロイ、運用、スケーリングをクラウド内で簡単に実行できるAWSが提供しているWebサービス
* AWSによって管理されたメモリ内のキャッシュから情報を取得できるようにすることで、Webアプリケーションのパフォーマンスを向上させることが出来る。

## Auto Scaling Group
* アプリケーションの負荷を処理するために適切な数のインスタンスを利用できるように準備することが出来る。
* これのインスタンスの最小数を指定することで、指定した数以下のサーバとなることがなくなる。最大数でも同じような設定にすることが出来る

## Amazon Route53
* 新規ドメイン名の登録や、ドメインのDNSレコードの管理が行える
* 権威DNSといって、ドメイン名とIPアドレスの返還情報を保持しているDNSのことである。変換情報を保持していないDNSはキャッシュDNSという。
* 権威DNSでは、保持しているドメイン名以外の名前解決をリクエストしても応答しない。

## Lambda
* イベントに応じてあらかじめLambda関数として登録したコードを実行するコンピューティングサービス
* 負荷状況に応じて実行環境が自動的に作成、並行で実行されるため、高いスケーラビリティのシステムを構築できる

## DynamoDB
* サーバレスのため、サーバー管理が不要である。
* すべてのデータを暗号化し、すべてのテーブルに対して細かいIDとアクセスコントロールをサポートしている
* Lambdaでトリガーを利用して、項目が変更されたときに、通知を送信するなどアクションを実行することが出来る
* アプリケーションのパフォーマンス状況を監視して設定されたキャパシティに基づいてスループットとストレージの自動スケーリングを行う。

## IAM (Identitiy and Access Management)
* AWSサーバへのアクセスを安全に管理するためのサービス
* サーバへのアクセス範囲や方法を制限することが出来る

## Cloud Front
* AWSのCDNのサービス
* CDNとは
    * CDN（コンテンツデリバリーネットワーク）とは、負荷分散をするためのコンテンツを配信する為だけのネットワーク
    * Webサーバを並べるだけとは違い、アクセス元から見て一番近くにあるサーバを自動で選択するシステム
    * これにより、表示などが高速化される
* 世界中の主要都市ほとんどに設置されているEdgeロケーションを介してコンテンツ配信を行うため高速で、さらにオリジンサーバのワークロードを減らし、アプリケーションの可用性を高めることが出来る

# 【追記】AWSの基本サービスについて
### 構成レビューの際、AWSの概要と[AWS単語帳](https://mynavi.docbase.io/posts/1977887)で出てくる単語を知っていれば、ある程度文章として読めると思うが、全体像をしっかり把握しなければ部分的な理解で終わってしまう。そのため全体像を軽くまとめておく。
--

### なぜAWSを使うのか？
クラウドサービスはGCPやAzureといったものが台頭しているが、AWSの特徴は何だろうか。
- 豊富なサービスで組み合わせ自由
- 安定したネットワーク、セキュリティ
- 利用者が多いため知見が集めやすい  

というように、自由度が高く（様々なサービスで利用可能）であり、運用の難易度も低いことから全世界で最も利用率が高いクラウドサービスとなっている。

### AWS理解には必須の用語
- **リージョン**  
世界を領域として分割し、領域ごと独立したクラウドサービスを展開している。(日本は東京と大阪）
- **アベイラビリティゾーン（AZ）**  
データセンター単位の区分け。リージョンをさらに細かくしたもの。AZが異なると物理的なデータセンターも異なる。障害発生時の影響範囲を抑える目的がある。
![image.png](https://image.docbase.io/uploads/d948f2c1-38f3-43c4-bb6b-f46e6da8d0f8.png =WxH)
- **VPC**  
プライベートなクラウド環境、ネットワークを制御できる。（IPアドレスの範囲、サブネット作成、ルートテーブルやネットワークゲートウェイの設定・・・）
- **インスタンス（Instance）**  
役割を与えられた領域、サーバ
- **IAM（アイアム）**  
ユーザ管理、アクセス制限、操作権限などを管理できる。

### 知っておきたい基本サービス
AWSはサービスが多く、自由度が高いのが特徴ではあるが、同時に**必要な知識量も多い**。そのため、まずは最低限の基本サービスをまとめる。

- **Amazon EC2**  
AWS上に仮想サーバを作るサービス。AWSにサーバを立てて、アプリケーションを動す方法の一つ。EC2で立てたサーバをインスタンスという。
- **AmazonEBS**  
EC2のデータを保存する領域、ストレージ。EC2にもデータを保存する領域はあるが、そちらはEC2を停止するとデータも消えてしまう仕様であり、サーバを停止してもデータが消えないようにするために必要。
- **AmazonS3**  
容量無制限のストレージ、容量の大きさが必要な場合、EBSよりも適している。構成例としてアクセスが頻繁なサーバはEBSで、バックアップなどをS３にする。
- **Route53**  
Amazonが提供するDNSサービス。PCからインターネット上に公開されているサイトなどにアクセスするためのDNSだけではなく、AWSとオンプレミス、AWS同士など、サーバとサーバをつなぐための名前解決などにも使う。
- **Amazon RDS**  
AWSが提供するマネージド型のDB。DBの運用をAWSがやってくれる。マルチAZ配置を選べば複数のAZにインスタンスが配置されるので可用性の高いシステムを実現できる。
